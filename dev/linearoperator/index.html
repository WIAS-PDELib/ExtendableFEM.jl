<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>LinearOperator · ExtendableFEM.jl</title><meta name="title" content="LinearOperator · ExtendableFEM.jl"/><meta property="og:title" content="LinearOperator · ExtendableFEM.jl"/><meta property="twitter:title" content="LinearOperator · ExtendableFEM.jl"/><meta name="description" content="Documentation for ExtendableFEM.jl."/><meta property="og:description" content="Documentation for ExtendableFEM.jl."/><meta property="twitter:description" content="Documentation for ExtendableFEM.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ExtendableFEM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../package_index/">Index</a></li><li><span class="tocitem">Problem Description</span><ul><li><a class="tocitem" href="../problemdescription/">Problem Description</a></li><li><a class="tocitem" href="../nonlinearoperator/">NonlinearOperator</a></li><li><a class="tocitem" href="../bilinearoperator/">BilinearOperator</a></li><li class="is-active"><a class="tocitem" href>LinearOperator</a><ul class="internal"><li><a class="tocitem" href="#Constructors"><span>Constructors</span></a></li><li><a class="tocitem" href="#Example-right-hand-side"><span>Example - right-hand side</span></a></li></ul></li><li><a class="tocitem" href="../interpolateboundarydata/">InterpolateBoundaryData</a></li><li><a class="tocitem" href="../homogeneousdata/">HomogeneousData</a></li><li><a class="tocitem" href="../fixdofs/">FixDofs</a></li><li><a class="tocitem" href="../combinedofs/">CombineDofs</a></li><li><a class="tocitem" href="../callbackoperator/">CallbackOperator</a></li></ul></li><li><span class="tocitem">Solving</span><ul><li><a class="tocitem" href="../pdesolvers/">Stationary Solvers</a></li><li><a class="tocitem" href="../pdesolvers_dt/">Time-dependent Solvers</a></li></ul></li><li><span class="tocitem">Postprocessing</span><ul><li><a class="tocitem" href="../postprocessing/">Other packages</a></li><li><a class="tocitem" href="../itemintegrators/">Item Integrators</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples_intro/">About the examples</a></li><li><a class="tocitem" href="../examples/Example103_BurgersEquation/">103 : Burger&#39;s Equation</a></li><li><a class="tocitem" href="../examples/Example105_NonlinearPoissonEquation/">105 : Nonlinear Poisson Equation</a></li><li><a class="tocitem" href="../examples/Example106_NonlinearDiffusion/">106 : Nonlinear Diffusion</a></li><li><a class="tocitem" href="../examples/Example108_RobinBoundaryCondition/">108 : Robin Boundary Condition</a></li><li><a class="tocitem" href="../examples/Example201_PoissonProblem/">201 : Poisson-Problem</a></li><li><a class="tocitem" href="../examples/Example202_MixedPoissonProblem/">202 : Poisson-Problem (Mixed)</a></li><li><a class="tocitem" href="../examples/Example205_HeatEquation/">205 : Heat equation</a></li><li><a class="tocitem" href="../examples/Example210_LshapeAdaptivePoissonProblem/">210 : Poisson L-shape Adaptive Mesh Refinement</a></li><li><a class="tocitem" href="../examples/Example211_LshapeAdaptiveEQPoissonProblem/">211 : Poisson L-shape Local Equilibrated Fluxes</a></li><li><a class="tocitem" href="../examples/Example220_ReactionConvectionDiffusion/">220 : Reaction-Convection-Diffusion-Problem</a></li><li><a class="tocitem" href="../examples/Example225_ObstacleProblem/">225 : Obstacle Problem</a></li><li><a class="tocitem" href="../examples/Example230_NonlinearElasticity/">230 : Nonlinear Elasticity</a></li><li><a class="tocitem" href="../examples/Example235_StokesIteratedPenalty/">235 : Stokes iterated penalty method</a></li><li><a class="tocitem" href="../examples/Example240_SVRTEnrichment/">240 : Stokes <span>$RT$</span> enrichment</a></li><li><a class="tocitem" href="../examples/Example245_NSEFlowAroundCylinder/">245 : Flow around a cylinder</a></li><li><a class="tocitem" href="../examples/Example250_NSELidDrivenCavity/">250 : Navier–Stokes Lid-driven cavity</a></li><li><a class="tocitem" href="../examples/Example252_NSEPlanarLatticeFlow/">252 : Navier–Stokes Planar Lattice Flow</a></li><li><a class="tocitem" href="../examples/Example260_AxisymmetricNavierStokesProblem/">260 : Axisymmetric Stokes</a></li><li><a class="tocitem" href="../examples/Example265_FlowTransport/">265 : Flow + Transport</a></li><li><a class="tocitem" href="../examples/Example270_NaturalConvectionProblem/">270 : Natural convection</a></li><li><a class="tocitem" href="../examples/Example280_CompressibleStokes/">240 : Compressible Stokes 2D</a></li><li><a class="tocitem" href="../examples/Example290_PoroElasticity/">290 : Poro-Elasticity</a></li><li><a class="tocitem" href="../examples/Example301_PoissonProblem/">201 : Poisson-Problem</a></li><li><a class="tocitem" href="../examples/Example310_DivFreeBasis/">310 : Div-free RT0 basis</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Problem Description</a></li><li class="is-active"><a href>LinearOperator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>LinearOperator</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="github.com/chmerdon/ExtendableFEM.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="LinearOperator"><a class="docs-heading-anchor" href="#LinearOperator">LinearOperator</a><a id="LinearOperator-1"></a><a class="docs-heading-anchor-permalink" href="#LinearOperator" title="Permalink"></a></h1><p>A linear operator allows to add vectors to the right-hand side of the system that usually refer to right-hand side data or linearisations of PDE operators (see remark in NonlinearOperator example).</p><h2 id="Constructors"><a class="docs-heading-anchor" href="#Constructors">Constructors</a><a id="Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Constructors" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.LinearOperator-Tuple{AbstractMatrix, Any, Any}" href="#ExtendableFEM.LinearOperator-Tuple{AbstractMatrix, Any, Any}"><code>ExtendableFEM.LinearOperator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function LinearOperator(
	A,
	u_test,
	u_args;
	kwargs...)</code></pre><p>Generates a linear form from a user-provided matrix A, which can be an AbstractMatrix or a FEMatrix with multiple blocks. The arguments u<em>args specify which coefficients of the current solution should be multiplied with the matrix and u</em>test specifies where to put the (blocks of the) resulting vector in the system right-hand side.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/chmerdon/ExtendableFEM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.LinearOperator-Tuple{Any, Any}" href="#ExtendableFEM.LinearOperator-Tuple{Any, Any}"><code>ExtendableFEM.LinearOperator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function LinearOperator(
	b,
	u_test;
	kwargs...)</code></pre><p>Generates a linear form from a user-provided vector b, which can be an AbstractVector or a FEVector with multiple blocks. The argument u_test specifies where to put the (blocks of the) vector in the system right-hand side.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/chmerdon/ExtendableFEM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.LinearOperator-Tuple{Any, Vector{&lt;:Tuple{Union{Int64, Unknown}, DataType}}, Vector{&lt;:Tuple{Union{Int64, Unknown}, DataType}}}" href="#ExtendableFEM.LinearOperator-Tuple{Any, Vector{&lt;:Tuple{Union{Int64, Unknown}, DataType}}, Vector{&lt;:Tuple{Union{Int64, Unknown}, DataType}}}"><code>ExtendableFEM.LinearOperator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function LinearOperator(
	kernel!::Function,
	oa_test::Array{&lt;:Tuple{Union{Unknown,Int}, DataType},1},
	oa_args::Array{&lt;:Tuple{Union{Unknown,Int}, DataType},1};
	kwargs...)</code></pre><p>Generates a nonlinear linear form that evaluates a kernel function that depends the operator evaluations of the current solution. The result of the kernel function is used in a vector product with the operator evaluation(s) of the test function(s). Hence, this can be used as a linearization of a nonlinear operator. The header of the kernel functions needs to be conform to the interface</p><pre><code class="nohighlight hljs">kernel!(result, eval_args, qpinfo)</code></pre><p>where qpinfo allows to access information at the current quadrature point.</p><p>Operator evaluations are tuples that pair an unknown identifier or integer with a Function operator.</p><p>Keyword arguments:</p><ul><li><p>factor: factor that should be multiplied during assembly. Default: 1</p></li><li><p>verbosity: verbosity level. Default: 0</p></li><li><p>time_dependent: operator is time-dependent ?. Default: false</p></li><li><p>name: name for operator used in printouts. Default: &#39;&#39;LinearOperator&#39;&#39;</p></li><li><p>entities: assemble operator on these grid entities (default = ON<em>CELLS). Default: ON</em>CELLS</p></li><li><p>quadorder: quadrature order. Default: &#39;&#39;auto&#39;&#39;</p></li><li><p>bonus_quadorder: additional quadrature order added to quadorder. Default: 0</p></li><li><p>regions: subset of regions where operator should be assembly only. Default: Any[]</p></li><li><p>params: array of parameters that should be made available in qpinfo argument of kernel function. Default: nothing</p></li><li><p>parallel_groups: assemble operator in parallel using CellAssemblyGroups. Default: false</p></li><li><p>store: store matrix separately (and copy from there when reassembly is triggered). Default: false</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/chmerdon/ExtendableFEM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.LinearOperator-Tuple{Any, Vector{&lt;:Tuple{Union{Int64, Unknown}, DataType}}}" href="#ExtendableFEM.LinearOperator-Tuple{Any, Vector{&lt;:Tuple{Union{Int64, Unknown}, DataType}}}"><code>ExtendableFEM.LinearOperator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function LinearOperator(
	[kernel!::Function],
	oa_test::Array{&lt;:Tuple{Union{Unknown,Int}, DataType},1};
	kwargs...)</code></pre><p>Generates a linear form that evaluates, in each quadrature point, the kernel function (if non is provided, a constant function one is used) and computes the vector product of the result with with the operator evaluation(s) of the test function(s). The header of the kernel functions needs to be conform to the interface</p><pre><code class="nohighlight hljs">kernel!(result, qpinfo)</code></pre><p>where qpinfo allows to access information at the current quadrature point, e.g. qpinfo.x are the global coordinates of the quadrature point.</p><p>Operator evaluations are tuples that pair an unknown identifier or integer with a Function operator.</p><p>Example: LinearOperator(kernel!, [id(1)]; kwargs...) generates the right-hand side for a Poisson problem, where kernel! evaluates the right-hand side.</p><p>Keyword arguments:</p><ul><li><p>factor: factor that should be multiplied during assembly. Default: 1</p></li><li><p>verbosity: verbosity level. Default: 0</p></li><li><p>time_dependent: operator is time-dependent ?. Default: false</p></li><li><p>name: name for operator used in printouts. Default: &#39;&#39;LinearOperator&#39;&#39;</p></li><li><p>entities: assemble operator on these grid entities (default = ON<em>CELLS). Default: ON</em>CELLS</p></li><li><p>quadorder: quadrature order. Default: &#39;&#39;auto&#39;&#39;</p></li><li><p>bonus_quadorder: additional quadrature order added to quadorder. Default: 0</p></li><li><p>regions: subset of regions where operator should be assembly only. Default: Any[]</p></li><li><p>params: array of parameters that should be made available in qpinfo argument of kernel function. Default: nothing</p></li><li><p>parallel_groups: assemble operator in parallel using CellAssemblyGroups. Default: false</p></li><li><p>store: store matrix separately (and copy from there when reassembly is triggered). Default: false</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/chmerdon/ExtendableFEM.jl">source</a></section></article><h2 id="Example-right-hand-side"><a class="docs-heading-anchor" href="#Example-right-hand-side">Example - right-hand side</a><a id="Example-right-hand-side-1"></a><a class="docs-heading-anchor-permalink" href="#Example-right-hand-side" title="Permalink"></a></h2><p>For a right-hand side operator of a Poisson problem with some given function <code>f(x)</code> a kernel could look like</p><pre><code class="language-julia hljs">function kernel!(result, qpinfo)
    result[1] = f(qpinfo.x)
end</code></pre><p>and the coressponding LinearOperator constructor call reads</p><pre><code class="language-julia hljs">u = Unknown(&quot;u&quot;)
NonlinearOperator(kernel!, [id(u)])</code></pre><p>The second argument triggers that the <code>result</code> vector of the kernel is multiplied with the Identity evaluation of the test function.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bilinearoperator/">« BilinearOperator</a><a class="docs-footer-nextpage" href="../interpolateboundarydata/">InterpolateBoundaryData »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Wednesday 20 September 2023 07:06">Wednesday 20 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

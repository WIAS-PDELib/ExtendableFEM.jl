<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time-dependent Solvers · ExtendableFEM.jl</title><meta name="title" content="Time-dependent Solvers · ExtendableFEM.jl"/><meta property="og:title" content="Time-dependent Solvers · ExtendableFEM.jl"/><meta property="twitter:title" content="Time-dependent Solvers · ExtendableFEM.jl"/><meta name="description" content="Documentation for ExtendableFEM.jl."/><meta property="og:description" content="Documentation for ExtendableFEM.jl."/><meta property="twitter:description" content="Documentation for ExtendableFEM.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ExtendableFEM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../package_index/">Index</a></li><li><span class="tocitem">Problem Description</span><ul><li><a class="tocitem" href="../problemdescription/">Problem Description</a></li><li><a class="tocitem" href="../nonlinearoperator/">NonlinearOperator</a></li><li><a class="tocitem" href="../bilinearoperator/">BilinearOperator</a></li><li><a class="tocitem" href="../linearoperator/">LinearOperator</a></li><li><a class="tocitem" href="../interpolateboundarydata/">InterpolateBoundaryData</a></li><li><a class="tocitem" href="../homogeneousdata/">HomogeneousData</a></li><li><a class="tocitem" href="../fixdofs/">FixDofs</a></li><li><a class="tocitem" href="../combinedofs/">CombineDofs</a></li><li><a class="tocitem" href="../callbackoperator/">CallbackOperator</a></li></ul></li><li><span class="tocitem">Solving</span><ul><li><a class="tocitem" href="../pdesolvers/">Stationary Solvers</a></li><li class="is-active"><a class="tocitem" href>Time-dependent Solvers</a><ul class="internal"><li><a class="tocitem" href="#Extension-ExtendableFEMDiffEQExt.jl"><span>Extension ExtendableFEMDiffEQExt.jl</span></a></li><li><a class="tocitem" href="#Example-:-2D-Heat-equation"><span>Example : 2D Heat equation</span></a></li></ul></li></ul></li><li><span class="tocitem">Postprocessing</span><ul><li><a class="tocitem" href="../postprocessing/">Other packages</a></li><li><a class="tocitem" href="../itemintegrators/">Item Integrators</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples_intro/">About the examples</a></li><li><a class="tocitem" href="../examples/Example103_BurgersEquation/">103 : Burger&#39;s Equation</a></li><li><a class="tocitem" href="../examples/Example105_NonlinearPoissonEquation/">105 : Nonlinear Poisson Equation</a></li><li><a class="tocitem" href="../examples/Example106_NonlinearDiffusion/">106 : Nonlinear Diffusion</a></li><li><a class="tocitem" href="../examples/Example108_RobinBoundaryCondition/">108 : Robin Boundary Condition</a></li><li><a class="tocitem" href="../examples/Example201_PoissonProblem/">201 : Poisson-Problem</a></li><li><a class="tocitem" href="../examples/Example202_MixedPoissonProblem/">202 : Poisson-Problem (Mixed)</a></li><li><a class="tocitem" href="../examples/Example204_LaplaceEVProblem/">204 : Eigenvalue problem for the Laplacian</a></li><li><a class="tocitem" href="../examples/Example205_HeatEquation/">205 : Heat equation</a></li><li><a class="tocitem" href="../examples/Example210_LshapeAdaptivePoissonProblem/">210 : Poisson L-shape Adaptive Mesh Refinement</a></li><li><a class="tocitem" href="../examples/Example211_LshapeAdaptiveEQPoissonProblem/">211 : Poisson L-shape Local Equilibrated Fluxes</a></li><li><a class="tocitem" href="../examples/Example220_ReactionConvectionDiffusion/">220 : Reaction-Convection-Diffusion-Problem</a></li><li><a class="tocitem" href="../examples/Example225_ObstacleProblem/">225 : Obstacle Problem</a></li><li><a class="tocitem" href="../examples/Example230_NonlinearElasticity/">230 : Nonlinear Elasticity</a></li><li><a class="tocitem" href="../examples/Example235_StokesIteratedPenalty/">235 : Stokes iterated penalty method</a></li><li><a class="tocitem" href="../examples/Example240_SVRTEnrichment/">240 : Stokes <span>$RT$</span> enrichment</a></li><li><a class="tocitem" href="../examples/Example245_NSEFlowAroundCylinder/">245 : Flow around a cylinder</a></li><li><a class="tocitem" href="../examples/Example250_NSELidDrivenCavity/">250 : Navier–Stokes Lid-driven cavity</a></li><li><a class="tocitem" href="../examples/Example252_NSEPlanarLatticeFlow/">252 : Navier–Stokes Planar Lattice Flow</a></li><li><a class="tocitem" href="../examples/Example260_AxisymmetricNavierStokesProblem/">260 : Axisymmetric Stokes</a></li><li><a class="tocitem" href="../examples/Example265_FlowTransport/">265 : Flow + Transport</a></li><li><a class="tocitem" href="../examples/Example270_NaturalConvectionProblem/">270 : Natural convection</a></li><li><a class="tocitem" href="../examples/Example275_OptimalControlStokes/">275 : Optimal Control Stokes</a></li><li><a class="tocitem" href="../examples/Example280_CompressibleStokes/">280 : Compressible Stokes 2D</a></li><li><a class="tocitem" href="../examples/Example290_PoroElasticity/">290 : Poro-Elasticity</a></li><li><a class="tocitem" href="../examples/Example301_PoissonProblem/">201 : Poisson-Problem</a></li><li><a class="tocitem" href="../examples/Example310_DivFreeBasis/">310 : Div-free RT0 basis</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solving</a></li><li class="is-active"><a href>Time-dependent Solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time-dependent Solvers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="github.com/chmerdon/ExtendableFEM.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Time-dependent-Solvers"><a class="docs-heading-anchor" href="#Time-dependent-Solvers">Time-dependent Solvers</a><a id="Time-dependent-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Time-dependent-Solvers" title="Permalink"></a></h1><p>For time-dependent (non-stationary) problems the user currently has these options:</p><ul><li>fully manual option: add custom time derivatives to the problem (i.e. a mass matrix as a BilinearOperator and necessary LinearOperators for evaluating the previous time step(s), if more than one previous time step needs to be remembered, their memorization must be handled manually, e.g. by registering further unknowns)</li><li>fully automatic option: reframe the ProblemDescription as an ODE problem and evolve it via DifferentialEquations with ExtendableFEMDiffEQExt.jl extension (see below)</li></ul><p>Several time-dependent examples are available where both options are implemented, see e.g. Examples103 (Burger&#39;s equation) and Example205 (Heat equation).</p><h2 id="Extension-ExtendableFEMDiffEQExt.jl"><a class="docs-heading-anchor" href="#Extension-ExtendableFEMDiffEQExt.jl">Extension ExtendableFEMDiffEQExt.jl</a><a id="Extension-ExtendableFEMDiffEQExt.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Extension-ExtendableFEMDiffEQExt.jl" title="Permalink"></a></h2><p>This extension is automatically loaded when also DifferentialEquations.jl is used. It allows to easily reframe the ProblemDescription for the spacial differential operator of the PDE as the right-hand side of an ODE. Here, the ProblemDescription contains the right-hand side description of the ODE</p><p class="math-container">\[\begin{aligned}
M u_t(t) &amp; = b(u(t)) - A(u(t)) u(t)
\end{aligned}\]</p><p>where A and b correspond to the assembled (linearized) spacial operator and the right-hand side operators in the ProblemDescription. Note, that A comes with a minus sign. The matrix M is the mass matrix and can be customized somewhat (as long as it stays constant). The operators in the ProblemDescription might depend on time (if their kernels use qpinfo.time) and will be reassembled in each time step. To avoid this single operator reassemblies can be switched off by using the store = true argument. The full matrix reassembly can be skipped if constant_matrix = true is used in the SolverConfiguration.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.generate_ODEProblem" href="#ExtendableFEM.generate_ODEProblem"><code>ExtendableFEM.generate_ODEProblem</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function generate_ODEProblem(
	PD::ProblemDescription,
	FES,
	tspan;
	mass_matrix = nothing)
	kwargs...)</code></pre><p>Reframes the ProblemDescription inside the SolverConfiguration into an ODEProblem, for DifferentialEquations.jl where tspan is the desired time interval.</p><p>If no mass matrix is provided the standard mass matrix for the respective finite element space(s) for all unknowns is assembled.</p><p>Additional keyword arguments:</p><ul><li><p>verbosity: verbosity level. Default: 0</p></li><li><p>sametol: tolerance to identify two solution vectors to be identical (and to skip reassemblies called by DifferentialEquations.jl). Default: 1.0e-15</p></li><li><p>constant_rhs: right-hand side is constant (skips reassembly). Default: false</p></li><li><p>init: initial solution (otherwise starts with a zero vector). Default: nothing</p></li><li><p>initialized: linear system in solver configuration is already assembled (turns true after first assembly). Default: false</p></li><li><p>constant_matrix: matrix is constant (skips reassembly and refactorization in solver). Default: false</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/chmerdon/ExtendableFEM.jl">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The solvers of DifferentialEquations should be run with the autodiff=false option as it is currently not possible to differentiate the right-hand side of the generated ODEProblem with respect to time.</p></div></div><h2 id="Example-:-2D-Heat-equation"><a class="docs-heading-anchor" href="#Example-:-2D-Heat-equation">Example : 2D Heat equation</a><a id="Example-:-2D-Heat-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Example-:-2D-Heat-equation" title="Permalink"></a></h2><p>The following ProblemDescription yields the space discretisation of the heat equation (including homogeneous boundary conditions and equivalent to the Poisson equation).</p><pre><code class="language-julia hljs">PD = ProblemDescription(&quot;Heat Equation&quot;)
u = Unknown(&quot;u&quot;; name = &quot;temperature&quot;)
assign_unknown!(PD, u)
assign_operator!(PD, BilinearOperator([grad(u)]; store = true, kwargs...))
assign_operator!(PD, HomogeneousBoundaryData(u))</code></pre><p>Given a finite element space FES and an initial FEVector sol for the unknown, the ODEProblem for some time interval (0,T) can be generated and solved via</p><pre><code class="language-julia hljs">prob = generate_ODEProblem(PD, FES, (0, T); init = sol)
DifferentialEquations.solve(prob, Rosenbrock23(autodiff = false), dt = 1e-3, dtmin = 1e-6, adaptive = true)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesolvers/">« Stationary Solvers</a><a class="docs-footer-nextpage" href="../postprocessing/">Other packages »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Thursday 21 September 2023 15:43">Thursday 21 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

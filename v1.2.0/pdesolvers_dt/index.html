<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time-dependent Solvers · ExtendableFEM.jl</title><meta name="title" content="Time-dependent Solvers · ExtendableFEM.jl"/><meta property="og:title" content="Time-dependent Solvers · ExtendableFEM.jl"/><meta property="twitter:title" content="Time-dependent Solvers · ExtendableFEM.jl"/><meta name="description" content="Documentation for ExtendableFEM.jl."/><meta property="og:description" content="Documentation for ExtendableFEM.jl."/><meta property="twitter:description" content="Documentation for ExtendableFEM.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ExtendableFEM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../package_index/">Index</a></li><li><span class="tocitem">Problem Description</span><ul><li><a class="tocitem" href="../problemdescription/">Problem Description</a></li><li><a class="tocitem" href="../tensordescription/">Tensor Description</a></li><li><a class="tocitem" href="../nonlinearoperator/">NonlinearOperator</a></li><li><a class="tocitem" href="../bilinearoperator/">BilinearOperator</a></li><li><a class="tocitem" href="../linearoperator/">LinearOperator</a></li><li><a class="tocitem" href="../interpolateboundarydata/">InterpolateBoundaryData</a></li><li><a class="tocitem" href="../homogeneousdata/">HomogeneousData</a></li><li><a class="tocitem" href="../fixdofs/">FixDofs</a></li><li><a class="tocitem" href="../combinedofs/">CombineDofs</a></li><li><a class="tocitem" href="../callbackoperator/">CallbackOperator</a></li><li><a class="tocitem" href="../allindex/">Index</a></li></ul></li><li><span class="tocitem">Solving</span><ul><li><a class="tocitem" href="../pdesolvers/">Stationary Solvers</a></li><li class="is-active"><a class="tocitem" href>Time-dependent Solvers</a><ul class="internal"><li><a class="tocitem" href="#Using-SciMLBase.ODEProblem-and-DifferentialEquations.jl"><span>Using SciMLBase.ODEProblem and DifferentialEquations.jl</span></a></li><li><a class="tocitem" href="#Example-:-2D-Heat-equation"><span>Example : 2D Heat equation</span></a></li></ul></li><li><a class="tocitem" href="../parallel_assembly/">Parallel Assembly</a></li></ul></li><li><span class="tocitem">Postprocessing</span><ul><li><a class="tocitem" href="../postprocessing/">Other packages</a></li><li><a class="tocitem" href="../itemintegrators/">Item Integrators</a></li><li><a class="tocitem" href="../faceinterpolator/">Face interpolator</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../module_examples/Example103_BurgersEquation/">Example103_BurgersEquation</a></li><li><a class="tocitem" href="../module_examples/Example105_NonlinearPoissonEquation/">Example105_NonlinearPoissonEquation</a></li><li><a class="tocitem" href="../module_examples/Example106_NonlinearDiffusion/">Example106_NonlinearDiffusion</a></li><li><a class="tocitem" href="../module_examples/Example108_RobinBoundaryCondition/">Example108_RobinBoundaryCondition</a></li><li><a class="tocitem" href="../module_examples/Example201_PoissonProblem/">Example201_PoissonProblem</a></li><li><a class="tocitem" href="../module_examples/Example202_MixedPoissonProblem/">Example202_MixedPoissonProblem</a></li><li><a class="tocitem" href="../module_examples/Example203_PoissonProblemDG/">Example203_PoissonProblemDG</a></li><li><a class="tocitem" href="../module_examples/Example204_LaplaceEVProblem/">Example204_LaplaceEVProblem</a></li><li><a class="tocitem" href="../module_examples/Example205_HeatEquation/">Example205_HeatEquation</a></li><li><a class="tocitem" href="../module_examples/Example206_CoupledSubGridProblems/">Example206_CoupledSubGridProblems</a></li><li><a class="tocitem" href="../module_examples/Example207_AdvectionUpwindDG/">Example207_AdvectionUpwindDG</a></li><li><a class="tocitem" href="../module_examples/Example210_LshapeAdaptivePoissonProblem/">Example210_LshapeAdaptivePoissonProblem</a></li><li><a class="tocitem" href="../module_examples/Example211_LshapeAdaptiveEQPoissonProblem/">Example211_LshapeAdaptiveEQPoissonProblem</a></li><li><a class="tocitem" href="../module_examples/Example212_PeriodicBoundary2D/">Example212_PeriodicBoundary2D</a></li><li><a class="tocitem" href="../module_examples/Example220_ReactionConvectionDiffusion/">Example220_ReactionConvectionDiffusion</a></li><li><a class="tocitem" href="../module_examples/Example225_ObstacleProblem/">Example225_ObstacleProblem</a></li><li><a class="tocitem" href="../module_examples/Example226_Thermoforming/">Example226_Thermoforming</a></li><li><a class="tocitem" href="../module_examples/Example230_NonlinearElasticity/">Example230_NonlinearElasticity</a></li><li><a class="tocitem" href="../module_examples/Example235_StokesIteratedPenalty/">Example235_StokesIteratedPenalty</a></li><li><a class="tocitem" href="../module_examples/Example240_SVRTEnrichment/">Example240_SVRTEnrichment</a></li><li><a class="tocitem" href="../module_examples/Example245_NSEFlowAroundCylinder/">Example245_NSEFlowAroundCylinder</a></li><li><a class="tocitem" href="../module_examples/Example250_NSELidDrivenCavity/">Example250_NSELidDrivenCavity</a></li><li><a class="tocitem" href="../module_examples/Example252_NSEPlanarLatticeFlow/">Example252_NSEPlanarLatticeFlow</a></li><li><a class="tocitem" href="../module_examples/Example260_AxisymmetricNavierStokesProblem/">Example260_AxisymmetricNavierStokesProblem</a></li><li><a class="tocitem" href="../module_examples/Example264_StokesDarcy/">Example264_StokesDarcy</a></li><li><a class="tocitem" href="../module_examples/Example265_FlowTransport/">Example265_FlowTransport</a></li><li><a class="tocitem" href="../module_examples/Example270_NaturalConvectionProblem/">Example270_NaturalConvectionProblem</a></li><li><a class="tocitem" href="../module_examples/Example275_OptimalControlStokes/">Example275_OptimalControlStokes</a></li><li><a class="tocitem" href="../module_examples/Example280_CompressibleStokes/">Example280_CompressibleStokes</a></li><li><a class="tocitem" href="../module_examples/Example282_IncompressibleMHD/">Example282_IncompressibleMHD</a></li><li><a class="tocitem" href="../module_examples/Example284_LevelSetMethod/">Example284_LevelSetMethod</a></li><li><a class="tocitem" href="../module_examples/Example285_CahnHilliard/">Example285_CahnHilliard</a></li><li><a class="tocitem" href="../module_examples/Example290_PoroElasticity/">Example290_PoroElasticity</a></li><li><a class="tocitem" href="../module_examples/Example301_PoissonProblem/">Example301_PoissonProblem</a></li><li><a class="tocitem" href="../module_examples/Example310_DivFreeBasis/">Example310_DivFreeBasis</a></li><li><a class="tocitem" href="../module_examples/Example312_PeriodicBoundary3D/">Example312_PeriodicBoundary3D</a></li><li><a class="tocitem" href="../module_examples/Example330_HyperElasticity/">Example330_HyperElasticity</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solving</a></li><li class="is-active"><a href>Time-dependent Solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time-dependent Solvers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/ExtendableFEM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/ExtendableFEM.jl/blob/master/docs/src/pdesolvers_dt.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Time-dependent-Solvers"><a class="docs-heading-anchor" href="#Time-dependent-Solvers">Time-dependent Solvers</a><a id="Time-dependent-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Time-dependent-Solvers" title="Permalink"></a></h1><p>For time-dependent (non-stationary) problems the user currently has these options:</p><ul><li>fully manual option: add custom time derivatives to the problem (i.e. a mass matrix as a BilinearOperator and necessary LinearOperators for evaluating the previous time step(s), if more than one previous time step needs to be remembered, their memorization must be handled manually, e.g. by registering further unknowns)</li><li>fully automatic option: reframe the ProblemDescription as an ODE problem and evolve it via DifferentialEquations with ExtendableFEMDiffEQExt.jl extension (see below)</li></ul><p>Several time-dependent examples are available where both options are implemented, see e.g. Examples103 (Burger&#39;s equation) and Example205 (Heat equation).</p><h2 id="Using-SciMLBase.ODEProblem-and-DifferentialEquations.jl"><a class="docs-heading-anchor" href="#Using-SciMLBase.ODEProblem-and-DifferentialEquations.jl">Using SciMLBase.ODEProblem and DifferentialEquations.jl</a><a id="Using-SciMLBase.ODEProblem-and-DifferentialEquations.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Using-SciMLBase.ODEProblem-and-DifferentialEquations.jl" title="Permalink"></a></h2><p>It is possible to reframe the ProblemDescription for the spatial differential operator of the PDE as the right-hand side of an ODEProblem. Here, the ProblemDescription contains the right-hand side description of the ODE</p><p class="math-container">\[\begin{aligned}
M u_t(t) &amp; = b(u(t)) - A(u(t)) u(t)
\end{aligned}\]</p><p>where A and b correspond to the assembled (linearized) spatial operator and the right-hand side operators in the ProblemDescription. Note, that A comes with a minus sign. The matrix M is the mass matrix and can be customized somewhat (as long as it stays constant). The operators in the ProblemDescription might depend on time (if their kernels use qpinfo.time) and will be reassembled in each time step. To avoid this single operator reassemblies can be switched off by using the store = true argument. The full matrix reassembly can be skipped if constant_matrix = true is used in the SolverConfiguration.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.generate_ODEProblem" href="#ExtendableFEM.generate_ODEProblem"><code>ExtendableFEM.generate_ODEProblem</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function generate_ODEProblem(
	PD::ProblemDescription,
	FES,
	tspan;
	mass_matrix = nothing)
	kwargs...)</code></pre><p>Reframes the ProblemDescription inside the SolverConfiguration into an ODEProblem, for DifferentialEquations.jl where tspan is the desired time interval.</p><p>If no mass matrix is provided the standard mass matrix for the respective finite element space(s) for all unknowns is assembled.</p><p>Additional keyword arguments:</p><ul><li><p><code>constant_matrix</code>: matrix is constant (skips reassembly and refactorization in solver). Default: false</p></li><li><p><code>constant_rhs</code>: right-hand side is constant (skips reassembly). Default: false</p></li><li><p><code>init</code>: initial solution (otherwise starts with a zero vector). Default: nothing</p></li><li><p><code>initialized</code>: linear system in solver configuration is already assembled (turns true after first assembly). Default: false</p></li><li><p><code>sametol</code>: tolerance to identify two solution vectors to be identical (and to skip reassemblies called by DifferentialEquations.jl). Default: 1.0e-15</p></li><li><p><code>verbosity</code>: verbosity level. Default: 0</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableFEM.jl/blob/af2c83af9bd07bb3f1ace0fba4f87739058cf472/src/solvers_diffeq.jl#L10-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.eval_jacobian!-NTuple{4, Any}" href="#ExtendableFEM.eval_jacobian!-NTuple{4, Any}"><code>ExtendableFEM.eval_jacobian!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Provides the jacobi matrix calculation function for DifferentialEquations.jl/ODEProblem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableFEM.jl/blob/af2c83af9bd07bb3f1ace0fba4f87739058cf472/src/diffeq_interface.jl#L129-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.eval_rhs!-NTuple{4, Any}" href="#ExtendableFEM.eval_rhs!-NTuple{4, Any}"><code>ExtendableFEM.eval_rhs!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Provides the rhs function for DifferentialEquations.jl/ODEProblem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableFEM.jl/blob/af2c83af9bd07bb3f1ace0fba4f87739058cf472/src/diffeq_interface.jl#L103-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.generate_ODEProblem-Tuple{ProblemDescription, Any, Any}" href="#ExtendableFEM.generate_ODEProblem-Tuple{ProblemDescription, Any, Any}"><code>ExtendableFEM.generate_ODEProblem</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function generate_ODEProblem(
	SC::SolverConfiguration,
	tspan;
	mass_matrix = nothing)
	kwargs...)</code></pre><p>Reframes the ProblemDescription inside the SolverConfiguration into a SciMLBase.ODEProblem, for DifferentialEquations.jl where tspan is the desired time interval.</p><p>If no mass matrix is provided the standard mass matrix for the respective finite element space(s) for all unknowns is assembled.</p><p>Keyword arguments:</p><ul><li><p><code>constant_matrix</code>: matrix is constant (skips reassembly and refactorization in solver). Default: false</p></li><li><p><code>constant_rhs</code>: right-hand side is constant (skips reassembly). Default: false</p></li><li><p><code>init</code>: initial solution (otherwise starts with a zero vector). Default: nothing</p></li><li><p><code>initialized</code>: linear system in solver configuration is already assembled (turns true after first assembly). Default: false</p></li><li><p><code>sametol</code>: tolerance to identify two solution vectors to be identical (and to skip reassemblies called by DifferentialEquations.jl). Default: 1.0e-15</p></li><li><p><code>verbosity</code>: verbosity level. Default: 0</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableFEM.jl/blob/af2c83af9bd07bb3f1ace0fba4f87739058cf472/src/diffeq_interface.jl#L5-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableFEM.jac_prototype-Tuple{Any}" href="#ExtendableFEM.jac_prototype-Tuple{Any}"><code>ExtendableFEM.jac_prototype</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Provides the system matrix as prototype for the jacobian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableFEM.jl/blob/af2c83af9bd07bb3f1ace0fba4f87739058cf472/src/diffeq_interface.jl#L151-L153">source</a></section></article><div class="admonition is-info" id="Note-3f65804bf6648120"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-3f65804bf6648120" title="Permalink"></a></header><div class="admonition-body"><p>The solvers of DifferentialEquations should be run with the autodiff=false option as it is currently not possible to differentiate the right-hand side of the generated ODEProblem with respect to time.</p></div></div><h2 id="Example-:-2D-Heat-equation"><a class="docs-heading-anchor" href="#Example-:-2D-Heat-equation">Example : 2D Heat equation</a><a id="Example-:-2D-Heat-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Example-:-2D-Heat-equation" title="Permalink"></a></h2><p>The following ProblemDescription yields the space discretisation of the heat equation (including homogeneous boundary conditions and equivalent to the Poisson equation).</p><pre><code class="language-julia hljs">PD = ProblemDescription(&quot;Heat Equation&quot;)
u = Unknown(&quot;u&quot;; name = &quot;temperature&quot;)
assign_unknown!(PD, u)
assign_operator!(PD, BilinearOperator([grad(u)]; store = true, kwargs...))
assign_operator!(PD, HomogeneousBoundaryData(u))</code></pre><p>Given a finite element space FES and an initial FEVector sol for the unknown, the ODEProblem for some time interval (0,T) can be generated and solved via</p><pre><code class="language-julia hljs">prob = generate_ODEProblem(PD, FES, (0, T); init = sol)
DifferentialEquations.solve(prob, Rosenbrock23(autodiff = false), dt = 1e-3, dtmin = 1e-6, adaptive = true)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesolvers/">« Stationary Solvers</a><a class="docs-footer-nextpage" href="../parallel_assembly/">Parallel Assembly »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Wednesday 4 June 2025 17:49">Wednesday 4 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
